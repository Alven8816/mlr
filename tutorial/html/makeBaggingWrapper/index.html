<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../img/favicon.ico">

        <title>Bagging - mlr tutorial</title>

        <link href="../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link href="../css/prettify-1.0.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->
            <a class="navbar-brand" href="..">mlr tutorial</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                
                
                    <li >
                        <a href="..">Home</a>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Basics <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            <li >
                                <a href="../task/">Tasks</a>
                            </li>
                        
                            <li >
                                <a href="../learner/">Learner</a>
                            </li>
                        
                            <li >
                                <a href="../train/">Train</a>
                            </li>
                        
                            <li >
                                <a href="../predict/">Predict</a>
                            </li>
                        
                            <li >
                                <a href="../performance/">Performance</a>
                            </li>
                        
                            <li >
                                <a href="../resample/">Resampling</a>
                            </li>
                        
                            <li >
                                <a href="../benchmark_experiments/">Benchmark Experiments</a>
                            </li>
                        
                            <li >
                                <a href="../parallelization/">Parallelization</a>
                            </li>
                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Advanced <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            <li >
                                <a href="../configureMlr/">Configuration</a>
                            </li>
                        
                            <li >
                                <a href="../wrapper/">Wrapper</a>
                            </li>
                        
                            <li class="active">
                                <a href="./">Bagging</a>
                            </li>
                        
                            <li >
                                <a href="../tune/">Tuning</a>
                            </li>
                        
                            <li >
                                <a href="../feature_selection/">Feature Selection</a>
                            </li>
                        
                            <li >
                                <a href="../cost_sensitive_classif/">Cost-Sensitive Classification</a>
                            </li>
                        
                            <li >
                                <a href="../over_and_undersampling/">Over- and Undersampling</a>
                            </li>
                        
                            <li >
                                <a href="../roc_analysis/">ROC Analysis</a>
                            </li>
                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Extend <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            <li >
                                <a href="../create_learner/">Create Custom Learners</a>
                            </li>
                        
                            <li >
                                <a href="../create_measure/">Create Custom Measures</a>
                            </li>
                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Appendix <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            <li >
                                <a href="../integrated_learners/">Integrated Learners</a>
                            </li>
                        
                            <li >
                                <a href="../measures/">Performance Measures</a>
                            </li>
                        
                        </ul>
                    </li>
                
                
                </ul>
            

            
            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
                
                
                <li >
                    <a rel="next" href="../wrapper/">
                        <i class="fa fa-arrow-left"></i> Previous
                    </a>
                </li>
                <li >
                    <a rel="prev" href="../tune/">
                        Next <i class="fa fa-arrow-right"></i>
                    </a>
                </li>
                
                
                <li>
                    <a href="https://github.com/berndbischl/mlr/">
                        
                            <i class="fa fa-github"></i>
                        
                        GitHub
                    </a>
                </li>
                
            </ul>
            
        </div>
    </div>
</div>

        <div class="container">
            <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#generic-bagging">Generic Bagging</a></li>
        
            <li><a href="#additional-measures">Additional Measures</a></li>
        
    
    </ul>
</div></div>
            <div class="col-md-9" role="main">

<h1 id="generic-bagging">Generic Bagging</h1>
<p>One reason why random forests perform so well is that they are using bagging as
a technique to gain more stability. But why do you want to limit yourself to the
classifiers already implemented in well known random forests when it is
really easy to build your own with <strong>mlr</strong>?</p>
<p>Just bag a learner already supported in <strong>mlr</strong> with <a href="http://www.rdocumentation.org/packages/mlr/functions/makeBaggingWrapper.html">makeBaggingWrapper</a>.</p>
<p>As in a random forest, we need a <a href="http://www.rdocumentation.org/packages/mlr/functions/makeLearner.html">Learner</a> which is trained on a subset of the
data during each iteration of the bagging process.
The subsets are chosen according to the parameters given to <a href="http://www.rdocumentation.org/packages/mlr/functions/makeBaggingWrapper.html">makeBaggingWrapper</a>:
<em> <code>bw.iters</code> On how many subsets (samples) do we want to train our <a href="http://www.rdocumentation.org/packages/mlr/functions/makeLearner.html">Learner</a>?
</em> <code>bw.replace</code> Sample with replacement (also known as <em>bootstrapping</em>)?
<em> <code>bw.size</code> Percentage size of the samples. If <code>bw.replace = TRUE</code>, <code>bw.size = 1</code> is the default. This does not mean that one sample will contain all the observations as observations will occur multiple times in each sample.
</em> <code>bw.feats</code> Percentage size of randomly selected features for each iteration.</p>
<p>Of course we also need a <a href="http://www.rdocumentation.org/packages/mlr/functions/makeLearner.html">Learner</a> which we have to pass to
<a href="http://www.rdocumentation.org/packages/mlr/functions/makeBaggingWrapper.html">makeBaggingWrapper</a>.</p>
<pre class="prettyprint well"><code class="r">lrn = makeLearner(&quot;classif.PART&quot;)
bagLrn = makeBaggingWrapper(lrn, bw.iters = 50, bw.replace = TRUE, bw.size = 0.8, bw.feats = 3/4)
</code></pre>

<p>Now we can compare the performance with and without bagging.
First let's try it without bagging:</p>
<pre class="prettyprint well"><code class="r">r = resample(learner = lrn, task = sonar.task, resampling = sonar.rin, show.info = FALSE)
r$aggr
</code></pre>

<pre class="prettyprint well"><code>## mmce.test.mean 
##         0.2452
</code></pre>

<p>And now with bagging:</p>
<pre class="prettyprint well"><code class="r">result = resultBagging = resample(learner = bagLrn, task = sonar.task, resampling = sonar.rin, show.info = FALSE)
result$aggr
</code></pre>

<pre class="prettyprint well"><code>## mmce.test.mean 
##         0.1634
</code></pre>

<p>Training more learners takes more time, but can outperform pure learners
on noisy data with many features.</p>
<h2 id="additional-measures">Additional Measures</h2>
<p>With bagging, you can get an estimated standard deviation regardless of the
wrapped learner. Below, we give a small example for regression.</p>
<pre class="prettyprint well"><code class="r">n = bh.task$task.desc$size
train.inds = seq(1, n, 3)
test.inds  = setdiff(1:n, train.inds)
lrn = makeLearner(&quot;regr.randomForest&quot;)
bagLrn = makeBaggingWrapper(lrn, predict.type = &quot;se&quot;)
</code></pre>

<pre class="prettyprint well"><code>## Error: unbenutztes Argument (predict.type = &quot;se&quot;)
</code></pre>

<pre class="prettyprint well"><code class="r">mod = train(learner = bagLrn, task = bh.task, subset = train.inds)
</code></pre>

<pre class="prettyprint well"><code>## Error: Task 'BostonHousing-example' is 'regr', but learner
## 'classif.PART.bagged' is for 'classif'!
</code></pre>

<pre class="prettyprint well"><code class="r">pred = predict(mod, task = bh.task, subset = test.inds)
</code></pre>

<pre class="prettyprint well"><code>## Error: Objekt 'mod' nicht gefunden
</code></pre>

<pre class="prettyprint well"><code class="r">head(pred$data)
</code></pre>

<pre class="prettyprint well"><code>## Error: Objekt 'pred' nicht gefunden
</code></pre>

<p>In the column labelled <code>se</code>, the standard deviation for each prediction (<code>response</code>) is given.</p>
<p>Let's visualise this a bit using <a href="http://ggplot2.org/">ggplot2</a>.
Here we plot the percentage of lower status of the population (<code>lstat</code>) against the prediction.</p>
<pre class="prettyprint well"><code class="r">library(&quot;ggplot2&quot;)
library(&quot;reshape2&quot;)
data = cbind(pred$data, BostonHousing[test.inds,])
</code></pre>

<pre class="prettyprint well"><code>## Error: Objekt 'pred' nicht gefunden
</code></pre>

<pre class="prettyprint well"><code class="r">g = ggplot(data, aes(x=lstat, y=response, ymin=response-se, ymax=response+se, col=age))
</code></pre>

<pre class="prettyprint well"><code>## Error: ggplot2 doesn't know how to deal with data of class function
</code></pre>

<pre class="prettyprint well"><code class="r">g + geom_point() + geom_linerange(alpha=0.5)
</code></pre>

<pre class="prettyprint well"><code>## Error: Objekt 'g' nicht gefunden
</code></pre>

<p>FIXME: getBaggingModels</p>
</div>
        </div>

        <footer class="col-md-12">
            <hr>
            
            <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>

        

        <script src="https://code.jquery.com/jquery-1.10.2.min.js"></script>
        <script src="../js/bootstrap-3.0.3.min.js"></script>
        <script src="../js/prettify-1.0.min.js"></script>
        <script src="../js/base.js"></script>
        
    </body>
</html>